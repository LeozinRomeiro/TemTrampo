@inject AppDbContext _context

<MudDialog>
    <DialogContent>
        <EditForm Model="@model" OnValidSubmit="@SubmeterValido">
            <DataAnnotationsValidator />
            <MudGrid>
                <MudItem xs="12">
                    <MudText Typo="Typo.body2" Align="Align.Center">
                        <ValidationSummary />
                    </MudText>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudCard>
                        <MudCardContent>
                            <MudTextField @bind-Value="@model.Titulo" Label="Titulo" For="@(() => model.Titulo)" />
                            <MudTextField @bind-Value="@model.Numero" Label="Numero" InputType="InputType.Telephone" For="@(() => model.Numero)" />
                            <MudTextField @bind-Value="@model.Email" Label="Email" InputType="InputType.Email" For="@(() => model.Email)" />
                            <MudTextField @bind-Value="@model.Empresa" Label="Empresa" For="@(() => model.Empresa)" />
                            <MudTextField @bind-Value="@model.Escolaridade" Label="Escolaridade" For="@(() => model.Escolaridade)" />
                        </MudCardContent>
                    </MudCard>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudCard>
                        <MudCardContent>
                            <MudTextField @bind-Value="@model.Descricao" Label="Descricao" For="@(() => model.Descricao)" />
                            <MudTextField @bind-Value="@model.Requisito" Label="Requisito" For="@(() => model.Requisito)" />
                            <MudTextField @bind-Value="@model.Desejavel" Label="Desejavel" For="@(() => model.Desejavel)" />
                            <MudTextField @bind-Value="@model.Beneficios" Label="Beneficios" For="@(() => model.Beneficios)" />
                        </MudCardContent>
                    </MudCard>
                </MudItem>
            </MudGrid>
            <MudCardActions>
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary">Cadastrar</MudButton>
            </MudCardActions>
        </EditForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Primary" OnClick="Submit">Ok</MudButton>
    </DialogActions>
</MudDialog>


@code {
    private VagaViewModel model = new VagaViewModel();

    private async Task SubmeterValido()
    {
        try
        {
            var vaga = new Vaga
                {
                    Titulo = model.Titulo,
                    Numero = model.Numero,
                    Email = model.Email,
                    Empresa = model.Empresa,
                    Escolaridade = model.Escolaridade,
                    Descricao = model.Descricao,
                    Requisito = model.Requisito,
                    Desejavel = model.Desejavel,
                    Beneficios = model.Beneficios

                };
            await _context.Vagas.AddAsync(vaga);
            await _context.SaveChangesAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Erro ao submeter o formulário: {ex.Message}");
        }

    }

    [CascadingParameter] MudDialogInstance MudDialog { get; set; }

    void Submit() => MudDialog.Close(DialogResult.Ok(true));
    void Cancel() => MudDialog.Cancel();
}